Miles Raymond (Paul Giamatti) is an unsuccessful writer, a wine-aficionado, and a depressed middle school English teacher living in San Diego, who takes his soon-to-be-married actor friend and college roommate, Jack Cole (Thomas Haden Church), on a road trip through Santa Ynez Valley wine country. Miles wants to relax and live well. However, Jack wants one last sexual fling.In the wine country, the men encounter Maya (Virginia Madsen), a waitress at Miles's favorite restaurant, The Hitching Post, and her friend, Stephanie (Sandra Oh), an employee at a local winery. They arrange a double date without revealing that Jack is to be married. Jack has an affair with Stephanie while Miles and Maya connect. Miles accidentally tells Maya that Jack is to be married. Enraged by the dishonesty, Maya dumps Miles and tells Stephanie, who breaks Jack's nose using her motorcycle helmet.Upon finding out his manuscript has been rejected again, Miles makes a scene at a wine tasting room, and Jack hooks up with another waitress named Cammi. Jack gets into deeper trouble when Cammi's husband comes home unexpectedly & has to flee without his clothes and wallet (which contains the wedding rings). Miles sneaks into Cammi's house and barely escapes with Jack's wallet. To explain the broken nose to his fiancée, Jack runs Miles's car into a ditch to create front-end damage and tells her that he was hurt in an accident.At the wedding, Miles runs into his ex-wife Vicki and meets her new husband. After learning that she is also pregnant, Miles faces the fact that Vicki will never return to him. Alone, he drinks his prized wine, a 1961 Château Cheval Blanc from a disposable coffee cup at a fast-food restaurant. Later, he receives a message from Maya, who says she enjoyed his manuscript and invites him to visit. The last scene in the movie shows Miles back in Santa Ynez, knocking on Maya's door.