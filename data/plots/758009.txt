The film opens on an island resort in the Philippines. Families and friends are gathered for the wedding of Darcy Rivera (Jennifer Lopez) and Tom Fowler (Josh Duhamel). Darcy shows up to a dinner where she meets with her mother, Renata (Sonia Braga), who thinks the big wedding is too flashy. Meanwhile, Tom is setting up a surprise for Darcy on a motorboat but gets startled by the security guard, causing him to fall into the water.Tom's mother, Carol (Jennifer Coolidge), arrives with her second husband, Larry (Steve Coulter). At the same time, Darcy's father, Robert (Cheech Marin), shows up with his new younger girlfriend, Harriet (D'Arcy Carden), which annoys Renata since she still hates Robert after their divorce. While Darcy and Tom try to spend time together, Tom gets pulled away by his best friend/best man Ricky (Desmin Borges), leaving Darcy to be with her younger sister Jamie (Callie Hernandez). Complicating matters is the arrival of Darcy's charming ex-boyfriend Sean (Lenny Kravitz), who was invited by Robert. He calls Darcy "Dee Dee," and his presence puts Tom on edge, with everyone seeing he is clearly jealous. Tom delivers a speech that is upstaged by Sean's more personal speech toward Darcy. This is followed by Tom's sister Jeannie (Melissa Hunter) delivering a speech discussing her recent marital problems.Darcy and Tom try to wind down and get intimate with one another, but it is interrupted by Carol coming in to offer words that she thinks are encouraging, but they really aren't. The couple ends up sleeping separately.The next morning is wedding day. As preparations are being made, a group of pirates makes their way toward the island after seeing the couple's wedding website. Darcy is helped by Renata, Jamie, and Carol into her dress, but she feels that something isn't right. She texts Tom to meet privately, and Darcy says she feels that having everyone come to the Philippines for their wedding was too much, as she never wanted a big wedding. They argue until they decide that they ought to call off the wedding, just as the pirates storm the resort and take the staff and guests hostage. Tom witnesses this and runs to warn Darcy. The pirates force everyone into a pool and demand a $45 million ransom from Robert, as they know how wealthy he is.Tom gets Darcy out of her room and tells her what's happening. They see an armed pirate attempting to break in and try to come up with a plan to trap him. While they attempt to subdue him with their own ideas (Tom wants to trap him in a net while Darcy thinks spraying his eyes with hairspray would do the trick), they both get taken down and are tied up together. The pirates then head with the couple to bring them to their leader, but Darcy asks for a cigarette and uses it to light the pirates' heads on fire, causing them to jump out and leaving the couple to try and take control of the driver less cart. They manage to jump out, but Darcy's dress gets caught and is mostly ripped off as the cart falls over a cliff. They are then attacked by one of the pirates, but Darcy manages to pull a grenade from his hand, and Tom kicks him and makes him fall against a rock, killing him. This leaves him mortified at killing a man.Darcy and Tom try to find a way to untie themselves, but Tom informs Darcy to be careful with the grenade she is holding because it doesn't have a pin in it, and her dropping it could set it off. They try to find an area with good cell reception so they can call for help, but they get chased by more pirates, and Darcy drops the phone. They find a zip line tower where they descend, and Darcy drops the grenade on two pirates, which alerts the others to their location when it blows up. When the couple lands, they are scared to see their loved ones being held hostage and try to find a way to get help.The couple goes into the kitchen to find a way to cut their bindings. A female pirate enters just as they cut themselves free with a deli slicer (but Tom gets a nasty cut on his hand that makes Darcy faint). Tom fights the pirate until he knocks her out by smashing her through a glass window. When Darcy comes to her senses, she shortens her dress and wears boots so she can spring into action and help Tom save their loved ones.Darcy and Tom find the main office of the resort but find that they have no internet. The owners, Margy (Selena Tan) and Ace (Alberto Isaac), hide the couple in their bunker. While tending to Tom's wound, Margy lets it slip that the resort was hit by pirates the previous summer, which Tom had known about. Darcy yells at Tom over this and his habit of self-sabotaging and his insecurities, which is what led him to make the big wedding. Tom hits back that Darcy is putting on a big front of being confident when she is also scared. Tom then takes responsibility for the hostages since he brought them all there. When another pirate starts getting close, Ace and Margy send the couple down a tunnel, but Tom gets out and turns himself in to be captured, leaving Darcy hidden.Tom is brought to the other hostages. He tells the lead pirate a phrase in Balinese (which means "fuck your grandpa"), and he then holds Sean at knife-point. Tom deduced that Sean is the bad guy who hired the pirates because Sean had said the phrase earlier, and Tom figured the pirates are Balinese. He even produces a wedding invitation that one of the pirates had, and Tom states that Sean had hoped to get the ransom from Robert since he did not give him investment money. Sean drops the act and breaks free, joining the pirates and holding a gun at Tom.Darcy begins to feel bad while staying with Ace and Margy over her argument with Tom, so she is encouraged to save everyone herself. Sean takes the lead pirate with him to go find Darcy, using Harriet as collateral and taking her with him in his helicopter. Darcy arrives with a gun and tries to reconcile with Tom before taking on the pirates. The pirates end up taking Darcy with the other hostages, with one of the pirates personally wanting to kill Darcy because she burned his face. The others then learn that Harriet was in on the scheme the whole time, as Larry had been recording everything and got footage of her and Sean making out. While in the helicopter, Harriet kills the lead pirate by hitting a pressure point to paralyze him and then throws him out of the helicopter.Darcy and Tom devise a plan by doing an impromptu wedding ceremony in the pool, which the pirates allow. Carol leads everyone to sing the song "I'll Be" before the couple seizes an opportunity to fight back (with Carol getting her hands on a rifle too). They use another grenade to kill the pirates, setting off some fireworks that alert Sean and Harriet. Ace and Margy help the guests get to safety while Darcy and Tom try to stop the villains.The couple makes it to the docks, where they subdue a young pirate and try to take the motorboat that Tom was going to surprise Darcy with. They are found by Sean, who attempts to get Darcy on his side, but she refuses to join him. She and Tom hop in the boat while Sean hangs on to go after them. Harriet attempts to shoot at them from the helicopter. As Darcy speeds the boat up, Tom and Sean get caught in a para-sail that flies upwards. Tom uses a chunk of fake hair to zip line down, and Darcy uses a cake knife that Carol gave her to cut the para-sail loose, causing Sean to get shredded by the helicopter's blades, and Harriet goes down into the ocean when the helicopter crashes.Darcy and Tom make it back to the island, where they fully reconcile and agree to go on with their wedding. Authorities show up to arrest the surviving pirates, and Darcy and Tom finally get married. Jamie and Ricky (who were hooking up) then accidentally set off the last firework.